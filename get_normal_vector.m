function normal_vector = get_normal_vector(mask, coordination)
    %% angle_table
    % pixel assignment
    % 1   2   3
    % 8       4
    % 7   6   5
    % Con_Vec = [128   64  32
    %             1    0   16
    %             2    4   8];
    % Each pixel corresponds to a different value, and then we can convert the
    % patch to a value in [0,255] according to pixels'
    % existing/missing situation
    angle_table= zeros(1,256);
    % angle
    angle_table(1) = 0; 
    angle_table(2) = 45;
    angle_table(3) = 22.5;
    angle_table(4) = 90;
    angle_table(5) = 45; % two missing continuous area
    angle_table(6) = 67.5;
    angle_table(7) = 45;
    angle_table(8) = 135;
    angle_table(9) = 67.5; % two missing continuous area
    angle_table(10) = 90; % two missing continuous area
    angle_table(11) = 67.5; % two
    angle_table(12) = 112.5;
    angle_table(13) = 67.5; % two
    angle_table(14) = 90;
    angle_table(15) = 67.5;
    angle_table(16) = 180;
    angle_table(17) = -90; % 
    angle_table(18) = 112.5; % two
    angle_table(19) = 90; % two
    angle_table(20) = 135; % two
    angle_table(21) = 90; % three missing 
    angle_table(22) = 112.5;
    angle_table(23) = 90;
    angle_table(24) = 157.5;
    angle_table(25) = 90;
    angle_table(26) = 112.5;
    angle_table(27) = 90;
    angle_table(28) = 135;
    angle_table(29) = 90;
    angle_table(30) = 112.5;
    angle_table(31) = 90;
    angle_table(32) = -135;
    angle_table(33) = -67.5;
    angle_table(34) = -45;
    angle_table(35) = -45;
    angle_table(36) = 157.5;
    angle_table(37) = -22.5;
    angle_table(38) = 135;
    angle_table(39) = -22.5;
    angle_table(40) = 180;
    angle_table(41) = -112.5;
    angle_table(42) = 135;
    angle_table(43) = 112.5;
    angle_table(44) = 157.5;
    angle_table(45) = 112.5;
    angle_table(46) = 135;
    angle_table(47) = 112.5;
    angle_table(48) = -157.5;
    angle_table(49) = -90;
    angle_table(50) = 135;
    angle_table(51) = -67.5;
    angle_table(52) = 157.5;
    angle_table(53) = 112.5;
    angle_table(54) = 135;
    angle_table(55) = 112.5;
    angle_table(56) = 180;
    angle_table(57) = -112.5;
    angle_table(58) = 135;
    angle_table(59) = 112.5;
    angle_table(60) = 157.5;
    angle_table(61) = 112.5;
    angle_table(62) = 135;
    angle_table(63) = 112.5;
    angle_table(64) = -90;
    angle_table(65) = -45;
    angle_table(66) = -22.5;
    angle_table(67) = -22.5;
    angle_table(68) = 0;
    angle_table(69) = 0;
    angle_table(70) = 0;
    angle_table(71) = 0;
    angle_table(72) = -157.5;
    angle_table(73) = -112.5;
    angle_table(74) = 22.5;
    angle_table(75) = 22.5;
    angle_table(76) = 180;
    angle_table(77) = 22.5;
    angle_table(78) = 22.5;
    angle_table(79) = 22.5;
    angle_table(80) = -135;
    angle_table(81) = -90;
    angle_table(82) = -67.5;
    angle_table(83) = -67.5;
    angle_table(84) = 180;
    angle_table(85) = -45;
    angle_table(86) = 157.5;
    angle_table(87) = -45;
    angle_table(88) = -157.5;
    angle_table(89) = -112.5;
    angle_table(90) = 157.5;
    angle_table(91) = -90;
    angle_table(92) = 180;
    angle_table(93) = -135;
    angle_table(94) = 157.5;
    angle_table(95) = 45;
    angle_table(96) = -112.5;
    angle_table(97) = -67.5;
    angle_table(98) = -45;
    angle_table(99) = -45;
    angle_table(100) = 180;
    angle_table(101) = -22.5;
    angle_table(102) = -22.5;
    angle_table(103) = -22.5;
    angle_table(104) = -157.5;
    angle_table(105) = -112.5;
    angle_table(106) = 157.5;
    angle_table(107) = -90;
    angle_table(108) = 180;
    angle_table(109) = 0;
    angle_table(110) = 157.5;
    angle_table(111) = 0;
    angle_table(112) = -135;
    angle_table(113) = -90;
    angle_table(114) = -67.5;
    angle_table(115) = -67.5;
    angle_table(116) = 180;
    angle_table(117) = -45;
    angle_table(118) = 157.5;
    angle_table(119) = -45;
    angle_table(120) = -157.5;
    angle_table(121) = -112.5;
    angle_table(122) = 157.5;
    angle_table(123) = -90;
    angle_table(124) = 180;
    angle_table(125) = -135;
    angle_table(126) = 157.5;
    angle_table(127) = 135;
    angle_table(128) = -45;
    angle_table(129) = -22.5;
    angle_table(130) = 0;
    angle_table(131) = 0;
    angle_table(132) = 22.5;
    angle_table(133) = 22.5;
    angle_table(134) = 22.5;
    angle_table(135) = 22.5;
    angle_table(136) = -135;
    angle_table(137) = 45;
    angle_table(138) = 45;
    angle_table(139) = 45;
    angle_table(140) = 45;
    angle_table(141) = 45;
    angle_table(142) = 45;
    angle_table(143) = 45;
    angle_table(144) = -112.5;
    angle_table(145) = -90;
    angle_table(146) = -67.5;
    angle_table(147) = -67.5;
    angle_table(148) = -157.5;
    angle_table(149) = 67.5;
    angle_table(150) = 67.5;
    angle_table(151) = 67.5;
    angle_table(152) = -135;
    angle_table(153) = -67.5;
    angle_table(154) = 67.5;
    angle_table(155) = 67.5;
    angle_table(156) = -157.5;
    angle_table(157) = 67.5;
    angle_table(158) = 67.5;
    angle_table(159) = 67.5;
    angle_table(160) = -90;
    angle_table(161) = -67.5;
    angle_table(162) = -45;
    angle_table(163) = -45;
    angle_table(164) = -22.5;
    angle_table(165) = -22.5;
    angle_table(166) = -22.5;
    angle_table(167) = -22.5;
    angle_table(168) = -135;
    angle_table(169) = -112.5;
    angle_table(170) = -90;
    angle_table(171) = -90;
    angle_table(172) = -157.5;
    angle_table(173) = -135;
    angle_table(174) = 0;
    angle_table(175) = 0;
    angle_table(176) = -112.5;
    angle_table(177) = -90;
    angle_table(178) = -67.5;
    angle_table(179) = -67.5;
    angle_table(180) = -157.5;
    angle_table(181) = -45;
    angle_table(182) = -45;
    angle_table(183) = -45;
    angle_table(184) = -135;
    angle_table(185) = -112.5;
    angle_table(186) = -90;
    angle_table(187) = -90;
    angle_table(188) = -157.5;
    angle_table(189) = -135;
    angle_table(190) = 90;
    angle_table(191) = 90;
    angle_table(192) = -67.5;
    angle_table(193) = -45;
    angle_table(194) = -22.5;
    angle_table(195) = -22.5;
    angle_table(196) = 0;
    angle_table(197) = 0;
    angle_table(198) = 0;
    angle_table(199) = 0;
    angle_table(200) = -135;
    angle_table(201) = -112.5;
    angle_table(202) = 22.5;
    angle_table(203) = 22.5;
    angle_table(204) = -157.5;
    angle_table(205) = 22.5;
    angle_table(206) = 22.5;
    angle_table(207) = 22.5;
    angle_table(208) = -112.5;
    angle_table(209) = -90;
    angle_table(210) = -67.5;
    angle_table(211) = -67.5;
    angle_table(212) = -157.5;
    angle_table(213) = -45;
    angle_table(214) = -45;
    angle_table(215) = -45;
    angle_table(216) = -135;
    angle_table(217) = -112.5;
    angle_table(218) = -90;
    angle_table(219) = -90;
    angle_table(220) = -157.5;
    angle_table(221) = -135;
    angle_table(222) = 45;
    angle_table(223) = 45;
    angle_table(224) = -90;
    angle_table(225) = -67.5;
    angle_table(226) = -45;
    angle_table(227) = -45;
    angle_table(228) = -22.5;
    angle_table(229) = -22.5;
    angle_table(230) = -22.5;
    angle_table(231) = -22.5;
    angle_table(232) = -135;
    angle_table(233) = -112.5;
    angle_table(234) = 0;
    angle_table(235) = 0;
    angle_table(236) = -157.5;
    angle_table(237) = -135;
    angle_table(238) = 0;
    angle_table(239) = 0;
    angle_table(240) = -112.5;
    angle_table(241) = -90;
    angle_table(242) = -67.5;
    angle_table(243) = -67.5;
    angle_table(244) = -157.5;
    angle_table(245) = -45;
    angle_table(246) = -45;
    angle_table(247) = -45;
    angle_table(248) = -135;
    angle_table(249) = -112.5;
    angle_table(250) = -90;
    angle_table(251) = -90;
    angle_table(252) = -157.5;
    angle_table(253) = -135;
    angle_table(254) = 180;
    angle_table(255) = 0; % not missing pixel
    % convert angle to radian
    angle_table = angle_table * (pi/180);
    %% calculate normal vector
    fixed_vector = [128,64,32;1,0,16;2,4,8];
    angle = get_patch_data(mask, coordination, 3);
    angle = sum(angle(:) .* fixed_vector(:));
    normal_vector = [cos(angle_table(angle)), sin(angle_table(angle))];
end